% PRABHAT KUMAR RAI --- EE18MTECH01005
% CSP ASSIGNMENT 2
% PROBLEM 3 -- MATCHED FILTER
clear all, close all; clc; format long;
x = [-8.31662009587695e-13	0.634029328751641 -0.767445067471676 1.21423064425930 -0.398089786809545 0.577773754381422 0.836673932101677 -0.308971047587158	1.58778525229245 -0.182021563971272	1.08979021355278 0.955496287619025 0.101910213188460 1.83342544475812 -0.0328730083226371 1.47944976553274	0.951056516297123	0.416799687379008 1.91156787310481	0.0161320533298923	1.70710678118365 0.801827011717968	0.605004908232005	1.80383953270139 -0.0489434837048209	1.75534914481212	0.508323091823254 0.657549842333970	1.51612377556215	-0.220379314802769 1.63098631369702	0.0938778153096871	0.587785252289410 1.07806879773563	-0.469889032770565	1.36346871276806 -0.398089786807767	0.428535685869768	0.539117897404445 -0.753010516576522	1.00000000000013 -0.909928708031988 0.226248967323822 -0.0383550418345928 -1.01612377556313 0.598101848038048	-1.37787003224955 0.0330716683035159 -0.587785252288216 -1.20501828135071 0.216772751324045 -1.74119124600282 -0.101910213187831 -1.04773048637417 -1.27368995655362	-0.0924099202063116	-1.95105651629510 -0.140900308094125	-1.37037177295808	-1.19200765574847 -0.292893218816216	-1.97770261413640	-0.0638088080855569 -1.52794015341620	-0.951056516293349	-0.368309299489775 -1.81488605669931	0.128145116048447	-1.51612377556127 -0.565315643581117 -0.324423348820114	-1.48091766063180 0.412214747707523 -1.35396817701884 -0.0713070673777790 -0.187593110348669 -1.01612377555957 0.747339916547638 -1.08031399754952 0.477111137289843 -6.64924840784914e-13 -0.477111137294668	1.08031399755176 -0.747339916547943	1.01612377556041];
% calculation and plotting by fixed point (16 bits)
fixed_x=round(x*(2^14));   
Y1=0.5*fixed_x(1);
Y2=0.5*fixed_x(2)+0.1667*(fixed_x(1));
Y3=0.5*fixed_x(3)+0.1667*(fixed_x(2)+fixed_x(1));
Y4=0.5*fixed_x(4)+0.1667*(fixed_x(3)+fixed_x(2))+0.25*fixed_x(1);
Y=[Y1 Y2 Y3 Y4];
for n=5:length(fixed_x)
    Y5=0.5*fixed_x(n)+0.1667*(fixed_x(n-1)+fixed_x(n-2))+0.25*(fixed_x(n-3)+fixed_x(n-4));
    Y=[Y Y5];
end
Y6=Y/(2^14); 
subplot(3,2,1); stem(Y6); grid on; xlabel('n'); ylabel('y'); title('fixed point matched filter graph');
subplot(3,2,2); plot(Y6); grid on; xlabel('n'); ylabel('y'); title('fixed point matched filter graph');
% calculation and plotting by original 
z1=0.5*x(1);
z2=0.5*x(2)+0.1667*(x(1));
z3=0.5*x(3)+0.1667*(x(2)+x(1));
z4=0.5*x(4)+0.1667*(x(3)+x(2))+0.25*x(1);
z=[z1 z2 z3 z4];
for n=5:length(x)
    z5=0.5*x(n)+0.1667*(x(n-1)+x(n-2))+0.25*(x(n-3)+x(n-4));
    z=[z z5];
end
subplot(3,2,3); stem(z); grid on; xlabel('n'); ylabel('z'); title('original matched filter graph');
subplot(3,2,4); plot(z); grid on; xlabel('n'); ylabel('z'); title('original filter graph');
%error in original filter and  fixed point filter
error=z-Y6;
subplot(4,1,4); plot(error); grid on; xlabel('n'); ylabel('amp'); title('error graph');

